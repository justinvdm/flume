{"version":3,"file":null,"sources":["../src/utils/resultValue.js","../src/map.js","../src/utils/resultState.js","../src/reduce.js","../src/utils/identity.js","../src/filter.js","../src/sink.js","../src/strsplit.js","../src/bindInputs.js","../node_modules/flume-core/flume-core.js"],"sourcesContent":["function resultValue(value) {\n  return {value: value};\n}\n\n\nexport default resultValue;\n","import {maybeAsync} from './core';\nimport resultValue from './utils/resultValue';\n\n\nexport default function map(fn) {\n  fn = maybeAsync(fn);\n  return function mapFn(_, v, opts) {\n    return fn(v, opts).then(resultValue);\n  };\n}\n","function resultState(state) {\n  return {state: state};\n}\n\n\nexport default resultState;\n","import {maybeAsync} from './core';\nimport resultState from './utils/resultState';\n\n\nexport default function reduce(init, reducer) {\n  if (arguments.length < 2) {\n    reducer = init;\n    init = retNull;\n  }\n\n  reducer = maybeAsync(parseReducer(reducer));\n\n  return {\n    init: init,\n    transform: reduceFn\n  };\n\n  function reduceFn(state, v, opts) {\n    return reducer(state, v, opts).then(resultState);\n  }\n}\n\n\nfunction parseReducer(obj) {\n  if (typeof obj == 'function') return obj;\n  if (Array.isArray(obj)) return caseSourceOfReducer(obj);\n  throw new Error('Unsupported reducer type given to reduce(): ' + typeof obj);\n}\n\n\nfunction caseSourceOfReducer(pairs) {\n  var defaultFn = identityReducer;\n\n  if (typeof pairs[pairs.length - 1] == 'function') {\n    defaultFn = pairs[pairs.length - 1];\n    pairs = pairs.slice(0, -1);\n  }\n\n  return function caseSourceOfFn(state, v, opts) {\n    var source = opts.source;\n    var i = -1;\n    var n = pairs.length;\n    var pair;\n\n    while (++i < n) {\n      pair = pairs[i];\n      if (pair[0] === source) return pair[1](state, v, opts);\n    }\n\n    return defaultFn(state, v, opts);\n  };\n}\n\n\nfunction retNull() {\n  return null;\n}\n\n\nfunction identityReducer(state, v) {\n  return v;\n}\n","function identity(v) {\n  return v;\n}\n\n\nexport default identity;\n","import {nil, resolveSeq} from './core';\nimport identity from './utils/identity';\nimport resultValue from './utils/resultValue';\n\n\nexport default function filter(fn) {\n  fn = fn || identity;\n\n  return function filterFn(_, v, opts) {\n    return resolveSeq([fn(v, opts), v])\n      .then(test)\n      .then(resultValue);\n  };\n}\n\n\nfunction test(res) {\n  return res[0]\n    ? res[1]\n    : nil;\n}\n","import {maybeAsync} from './core';\nimport resultValue from './utils/resultValue';\n\n\nexport default function sink(init, fn) {\n  fn = maybeAsync(fn);\n\n  return {\n    init: init,\n    transform: sinkFn\n  };\n\n  function sinkFn(state, v, opts) {\n    return fn(state, v, opts).then(resultValue);\n  }\n}\n","function init() {\n  return '';\n}\n\n\nfunction strsplit(sep) {\n  function transform(data, chunk) {\n    var lines = (data + chunk).split(sep);\n    return {\n      state: lines.slice(-1),\n      values: lines.slice(0, -1)\n    };\n  }\n\n  return {\n    init: init,\n    transform: transform\n  };\n}\n\n\nexport default strsplit;\n","import {conj} from './core';\n\n\nexport default function bindInputs(bindFn, inputs) {\n  if (arguments.length < 2) {\n    inputs = bindFn;\n    bindFn = conj;\n  }\n\n  return function transformFn(inputFns, obj, opts) {\n    inputFns = inputFns || createInputFns(inputs, opts.dispatch);\n    return {\n      state: inputFns,\n      value: bindFn(obj, inputFns)\n    };\n  };\n\n  function createInputFns(inputs, dispatch) {\n    var res = {};\n\n    for (var k in inputs) {\n      if (inputs.hasOwnProperty(k)) res[k] = createInputFn(inputs[k], dispatch);\n    }\n\n    return res;\n  }\n\n  function createInputFn(input, dispatch) {\n    return function inputFn(v) {\n      dispatch(input, v);\n    };\n  }\n}\n",";(function(root, factory) {\n  if (typeof root.define === 'function' && root.define.amd) root.define(factory);\n  else if (typeof exports === 'object') factory(true);\n  else root.flume = factory();\n})(this, function(cjs) {\n  // api\n\n  var nil = message('flume:nil', null);\n\n\n  function input() {\n    return new InputDef();\n  }\n\n\n  function create(defs) {\n    var self = {};\n    self.dispatch = dispatch;\n    self.inputs = buildGraph(self, defs);\n\n    return self;\n\n    function dispatch(src, msgs, done) {\n      var nodes = inputsOf(self.inputs, src);\n      var n = nodes.length;\n      var i = -1;\n\n      done = callOnNth(n, done || noop);\n      while (++i < n) nodes[i].handle(msgs, done);\n\n      return self;\n    }\n  }\n\n\n  function message(type, v) {\n    return new Msg(type, v);\n  }\n\n\n  function except(fn) {\n    return trap({'flume:error': fn});\n  }\n\n\n  function trap(transform) {\n    return {\n      transform: conj({'*': trapFallbackMsgHandler}, transform)\n    };\n  }\n\n\n  // types\n\n  function Msg(type, value) {\n    this.type = type;\n    this.value = value;\n  }\n\n\n  function InputDef() {\n    this.defType = 'input';\n  }\n\n\n  function TransformDef(opts) {\n    this.defType = 'transform';\n    this.init = ensure(opts.init, noop);\n    this.transform = opts.transform;\n  }\n\n\n  function Node(graph, def, child, index) {\n    this.graph = graph;\n    this.def = def;\n    this.child = child;\n    this.index = index;\n    this.handle = createHandler(this);\n  }\n\n\n  // graph building\n\n  function buildGraph(graph, defs, child, index) {\n    var i = defs.length - 1;\n    if (i < 0) return [];\n\n    // tail\n    if (i) child = new Node(graph, createTransformDef(defs[i]), child, index);\n    while (--i > 0) child = new Node(graph, createTransformDef(defs[i]), child, 0);\n\n    return buildGraphHead(graph, defs[0], child);\n  }\n\n\n  function buildGraphHead(graph, defs, child) {\n    defs = castArray(defs);\n\n    var inputs = [];\n    var i = -1;\n    var def;\n    var n = defs.length;\n\n    while (++i < n) {\n      def = defs[i];\n\n      if (Array.isArray(def)) {\n        inputs.push.apply(inputs, buildGraph(graph, def, child, i));\n      } else if (def instanceof InputDef) {\n        inputs.push(new Node(graph, def, child, i));\n      } else {\n        throw new Error(\"Expected input or array but got \" + typeOf(def));\n      }\n    }\n\n    return inputs;\n  }\n\n\n  function createTransformDef(obj) {\n    if (typeof obj === 'function') {\n      obj = {\n        transform: {'flume:value': obj}\n      };\n    }\n    else if (typeof (obj || 0).transform === 'function') {\n      obj = conj(obj, {\n        transform: {'flume:value': obj.transform}\n      });\n    }\n    else if (typeOf((obj || 0).transform) !== 'object') {\n      throw new Error(\n        \"Expected function or object matching transform shape but got \" +\n        typeOf(obj));\n    }\n\n    return new TransformDef(obj);\n  }\n\n\n  // message transforming\n\n  function trapFallbackMsgHandler(state, v) {\n    return {state: v};\n  }\n\n\n  function createHandler(node) {\n    return {\n      input: createInputHandler,\n      transform: createTransformHandler\n    }[node.def.defType](node);\n  }\n\n\n  function createInputHandler(node) {\n    return function handle(msg, end) {\n      node.child.handle([msg], node, node, end);\n    };\n  }\n\n\n  function createTransformHandler(node) {\n    var queue = [];\n    var isBusy = false;\n    var task = null;\n    var state = node.def.init();\n    var transformAsync = maybeAsync(transform);\n\n    return function handle(msgs, parent, source, end) {\n      msgs = msgs.map(castMessage)\n      var i = -1;\n      var n = msgs.length - 1;\n\n      var taskDefaults = {\n        source: source,\n        parent: parent,\n      };\n\n      while (++i < n) schedule(conj(taskDefaults, {\n        msg: msgs[i],\n        end: noop\n      }));\n\n      if (n > -1) schedule(conj(taskDefaults, {\n        msg: msgs[n],\n        end: end\n      }));\n    };\n\n    function schedule(task) {\n      queue.push(task);\n      if (!isBusy) next();\n    }\n\n    function next() {\n      task = queue.shift();\n      if (task) run();\n    }\n\n    function run() {\n      isBusy = true;\n\n      return transformAsync()\n        .then(resolveSeq)\n        .then(success, failure);\n    }\n\n    function transform() {\n      var fns = node.def.transform;\n      var fn = fns[task.msg.type] || fns['*'];\n      return !fn\n        ? {value: task.msg}\n        : fn(state, task.msg.value, {\n          source: task.source.def,\n          parent: task.parent.def,\n          dispatch: node.graph.dispatch\n        });\n    }\n\n    function done(msgs) {\n      var currTask = task;\n      isBusy = false;\n      task = null;\n\n      if (node.child) node.child.handle(msgs, node, currTask.source, currTask.end);\n      else currTask.end();\n\n      next();\n    }\n\n    function success(res) {\n      res = normalizeResult(state, res);\n      state = res.state;\n      done(res.values);\n    }\n\n    function failure(e) {\n      if (!node.child) throw new UnhandledError(e);\n      done([message('flume:error', e)]);\n    }\n  }\n\n\n  // utils\n\n  function inputsOf(inputs, def) {\n    var res = [];\n    var n = inputs.length;\n    var i = -1;\n    var input;\n\n    while (++i < n) {\n      input = inputs[i];\n      if (input.def === def) res.push(input);\n    }\n\n    return res;\n  }\n\n\n  function conj() {\n    var res = {};\n    var objects = Array.prototype.slice.call(arguments);\n\n    var i = -1;\n    var n = objects.length;\n    var obj;\n\n    while (++i < n) {\n      obj = objects[i];\n      for (var k in obj) if (obj.hasOwnProperty(k)) res[k] = obj[k]\n    }\n\n    return res;\n  }\n\n\n  function noop() {\n    return null;\n  }\n\n\n  function ensure(v, defaultVal) {\n    return typeof v === 'undefined'\n      ? defaultVal\n      : v;\n  }\n\n\n  function identity(v) {\n    return v;\n  }\n\n\n  function throwError(e) {\n    throw e;\n  }\n\n\n  function castMessage(v) {\n    return !(v instanceof Msg)\n      ? message('flume:value', v)\n      : v;\n  }\n\n\n  function normalizeResult(state, raw) {\n    var hasState = raw.hasOwnProperty('state');\n    var values;\n\n    if (raw.hasOwnProperty('value')) values = [raw.value];\n    else if (raw.hasOwnProperty('values')) values = raw.values;\n    else if (hasState) values = [raw.state];\n\n    return {\n      values: values,\n      state: hasState\n        ? raw.state\n        : state\n    };\n  }\n\n\n  function castArray(v) {\n    return !Array.isArray(v)\n      ? [v]\n      : v;\n  }\n\n\n  function typeOf(v) {\n    return v !== null\n      ? typeof v\n      : 'null';\n  }\n\n\n  function callOnNth(n, fn) {\n    var i = 0;\n\n    return function onNthFn() {\n      if (++i >= n) fn.apply(null, arguments);\n    };\n  }\n\n\n  function maybeAsync(fn) {\n    return function maybeAsyncFn() {\n      try {\n        var v = fn.apply(this, arguments);\n        return castThenable(v);\n      } catch (e) {\n        if (e instanceof UnhandledError) throw e.error;\n        return thenableError(e);\n      }\n    }\n  }\n\n\n  function castThenable(v) {\n    return !isThenable(v)\n      ? thenableValue(v)\n      : v;\n  }\n\n\n  function thenableValue(v) {\n    return new Thenable(v, false);\n  }\n\n\n  function thenableError(e) {\n    return new Thenable(e, true);\n  }\n\n\n  function resolveSeq(values) {\n    return Array.isArray(values) && values.filter(isThenable).length > 0\n      ? resolveThenablesSeq(values)\n      : castThenable(values);\n  }\n\n\n  function resolveThenablesSeq(values) {\n    var res = [];\n    var n = values.length;\n    var i = -1;\n    var j = -1;\n    var p = thenableValue(null);\n\n    while (++i < n) p = p.then(call);\n    return p.then(done);\n\n    function call() {\n      return castThenable(values[++j]).then(push);\n    }\n\n    function push(v) {\n      res.push(v);\n    }\n\n    function done() {\n      return res;\n    }\n  }\n\n\n  function isThenable(v) {\n    return !!(v || 0).then;\n  }\n\n\n  function UnhandledError(error) {\n    this.error = error;\n  }\n\n\n  function Thenable(value, isFailure) {\n    this.value = value;\n    this.isFailure = isFailure;\n  }\n\n\n  Thenable.prototype.then = maybeAsync(function then(successFn, failureFn) {\n    if (this.isFailure) return (failureFn || throwError).call(this, this.value);\n    else return (successFn || identity).call(this, this.value);\n  });\n\n\n  if (cjs)\n    module.exports = {\n      create: create,\n      input: input,\n      message: message,\n      trap: trap,\n      except: except,\n      nil: nil,\n      conj: conj,\n      maybeAsync: maybeAsync,\n      resolveSeq: resolveSeq\n    }\n  else\n    return {\n      create: create,\n      input: input,\n      message: message,\n      trap: trap,\n      except: except,\n      nil: nil,\n      conj: conj,\n      maybeAsync: maybeAsync,\n      castThenable: castThenable,\n      resolveSeq: resolveSeq\n    };\n});\n"],"names":["resultValue","value","map","fn","maybeAsync","_","v","opts","then","resultState","state","reduce","init","reducer","reduceFn","arguments","length","retNull","parseReducer","transform","obj","Array","isArray","caseSourceOfReducer","Error","pairs","defaultFn","identityReducer","slice","pair","source","i","n","identity","filter","resolveSeq","test","res","nil","sink","sinkFn","strsplit","sep","data","chunk","lines","split","values","bindInputs","bindFn","inputs","createInputFns","dispatch","k","hasOwnProperty","createInputFn","input","conj","inputFns","root","factory","define","amd","exports","flume","this","cjs","InputDef","create","defs","src","msgs","done","nodes","inputsOf","self","callOnNth","noop","handle","buildGraph","message","type","Msg","except","trap","flume:error","*","trapFallbackMsgHandler","defType","TransformDef","ensure","Node","graph","def","child","index","createHandler","createTransformDef","buildGraphHead","castArray","push","apply","typeOf","flume:value","node","createInputHandler","createTransformHandler","msg","end","schedule","task","queue","isBusy","next","shift","run","transformAsync","success","failure","fns","parent","currTask","normalizeResult","e","UnhandledError","castMessage","taskDefaults","objects","prototype","call","defaultVal","throwError","raw","hasState","castThenable","error","thenableError","isThenable","thenableValue","Thenable","resolveThenablesSeq","j","p","isFailure","successFn","failureFn","module"],"mappings":"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"}